<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ScanGame — Layered Detection</title>
  </head>
  <body>
    <div style="display:flex; flex-direction:column; gap:16px; align-items:center; justify-content:flex-start; padding:12px; width:100%;">
      <div id="menu" style="position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.6); z-index:10;">
        <div style="background:#0b1020; border:1px solid #1f2a44; padding:16px 20px; border-radius:8px; color:#cfe8ff; font-family:monospace; min-width:360px;">
          <div style="font-size:18px; margin-bottom:8px;">Select your ship</div>
          <div id="ship-list" style="display:flex; flex-direction:column; gap:8px;"></div>
          <div style="margin-top:12px; font-size:12px; opacity:0.8;">W/S throttle, A/D rotate, Q/E arc, Space ping, Shift dark-run</div>
        </div>
      </div>
      <div id="app"></div>
      <div id="tutorial" style="padding: 24px;max-width:980px; color:#cfe9ff; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size:14px; line-height:1.5; text-align:left;">
        <h2 style="margin:0 0 8px 0; font-size:16px; color:#9ad0ff;">How to Play</h2>
        <p style="margin:0 0 8px 0;"><b>Before you start</b>: Pick a ship in the menu.
          <span style="opacity:0.9;">Classes change:</span>
          <br/>- <b>Speed/Acceleration</b> (handling)
          <br/>- <b>Baseline Noise</b> (how loud you idle/coast)
          <br/>- <b>Passive / Active base ranges</b> (sensor strength)
          <br/><span style="opacity:0.9;">Rule of thumb:</span> Frigate = faster/stealthier (shorter base ranges). Capital = slower/louder (longer base ranges).</p>
        <ul style="margin:0 8px 10px 18px; padding:0;">
          <li><b>Rotate</b>: A / D</li>
          <li><b>Throttle</b>: W / S — Thrust raises your <b>Noise Index (NI)</b>; coasting lowers it. Higher NI makes <i>you</i> detectable from farther away by others.</li>
          <li><b>Passive Arc</b>: Q / E — This controls your directional scan.
            <ul style="margin:4px 0 0 16px;">
              <li>Arc width range: <b>30°–180°</b>.</li>
              <li><b>Narrower arc</b> → <u>longer passive range</u> and <u>higher accuracy</u>; <b>wider arc</b> → more coverage but shorter range and fuzzier hits.</li>
              <li>Range rule: at <b>30°</b>, Passive effective range ≈ your <b>Active base</b>; at <b>180°</b>, Passive effective range ≈ your <b>Passive base</b>.</li>
              <li>Accuracy: returns have a positional error that scales ~<b>100–500 m</b> from narrow→wide arcs.</li>
              <li>Cost: each Passive return emits a small <b>reveal bubble</b>. Bubble size grows with arc width (wider arc = bigger bubble). Internally throttled ~<b>1.2 s</b>.</li>
            </ul>
          </li>
          <li><b>Active Ping</b>: Space — Emits a pulse revealing <b>exact</b> positions within your Active effective range.
            <ul style="margin:4px 0 0 16px;">
              <li><b>Cooldown</b>: ~<b>5 s</b> (see HUD bar). Contacts remain visible ~<b>1.2 s</b>.</li>
              <li><b>Risk</b>: creates a <b>large reveal bubble</b> and briefly spikes your NI (you become much easier to detect).</li>
              <li>Best used after Passive triangulation to confirm intercept.</li>
            </ul>
          </li>
          <li><b>Dark Run</b>: hold Shift — Reduces emitted NI to help you hide; works best when coasting and inside cover.</li>
          <li><b>Zoom</b>: Mouse wheel over the canvas — Zoom in/out around your ship (for situational awareness).</li>
        </ul>
        <p style="margin:0 0 8px 0;"><b>Objective</b>: Track with Passive + breadcrumbs; when you’re close, Ping to confirm and win. If the prey reaches the green gate before time ends, you lose.</p>
        <div style="margin:8px 0 8px 0;">
          <div style="margin:0 0 4px 0;"><b>Visuals</b></div>
          <ul style="margin:0 0 6px 18px; padding:0;">
            <li>Rings: Base ranges (thin) and <i>max-if-loud</i> ranges (brighter) for Ambient, Passive, Active. Labels are shown near the rings.</li>
            <li>Arc wedge: Passive field-of-view; effective Passive ring grows as you narrow the Arc</li>
            <li>Breadcrumbs: <span style="color:#79c6ff">blue</span> = passive (approximate), <span style="color:#ffc04d">orange</span> = decoys</li>
            <li>Red circles: reveal bubbles — small (Passive ticks), large (Active ping)</li>
          </ul>
        </div>
        <div style="margin:8px 0 0 0;">
          <div style="margin:0 0 4px 0;"><b>Scanning & Hybrid Detectability</b></div>
          <ul style="margin:0 0 6px 18px; padding:0;">
            <li><b>Ambient</b> (always on): short-range hints of <i>loud</i> targets; ignores Arc. Base ≈ your Ambient ring; louder targets can be heard up to the <i>Amb max-if-loud</i> ring.</li>
            <li><b>Passive</b> (Arc): returns fuzzy positions inside the wedge only. Narrower arc increases the <i>Pass effective</i> ring and reduces error. Hits drop <b>blue breadcrumbs</b> (~8 s).</li>
            <li><b>Active</b> (Ping): exact positions for a moment; large reveal pulse; obeys cooldown. Use to confirm and commit.</li>
            <li><b>Hybrid model</b> (what the rings mean):
              <ul style="margin:4px 0 0 16px;">
                <li><b>Base rings</b> (thin) = guaranteed minimum range.</li>
                <li><b>Max-if-loud rings</b> (brighter) = potential reach vs a <i>loud</i> target. Effective range scales with target NI (roughly a square-root curve) and is capped per layer (Amb ~1.5×, Pass ~1.75×, Act ~2.0× base).</li>
                <li>Environmental zones reduce target NI, shrinking your effective reach; thrust/weapons/pings increase NI, extending it.</li>
              </ul>
            </li>
          </ul>
        </div>
        <p style="margin:8px 0 0 0;"><b>Tips</b>: Sweep wide to find direction, narrow Arc to triangulate, then Ping. Use zones (shadows/thermal/clutter) to cut NI and break locks.</p>
      </div>
    </div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
